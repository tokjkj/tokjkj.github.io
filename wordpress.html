<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>Markdown 자동 정리 & 복사 도구</title>
<style>
body {
    font-family: '맑은 고딕', sans-serif;
    margin: 0;
    padding: 20px;
    background: #f5f5f5;
}
.container {
    display: flex;
    gap: 20px;
}
textarea {
    width: 48%;
    height: 500px;
    padding: 10px;
    font-family: 'Consolas', monospace;
    font-size: 14px;
    border: 1px solid #ccc;
    border-radius: 6px;
    resize: none;
    white-space: pre-wrap;
    overflow-wrap: break-word;
}
#output {
    background: #fdfdfd;
}
h2 {
    margin-bottom: 10px;
}
#copyAlert {
    display: none;
    position: fixed;
    top: 20px;
    right: 20px;
    background: #0078d7;
    color: white;
    padding: 10px 16px;
    border-radius: 8px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.2);
    animation: fadeInOut 1.5s forwards;
    z-index: 999;
}
@keyframes fadeInOut {
    0% { opacity: 0; transform: translateY(-10px); }
    10%, 90% { opacity: 1; transform: translateY(0); }
    100% { opacity: 0; transform: translateY(-10px); }
}
</style>
</head>
<body>

<h2>Markdown 자동 정리 & 복사 도구</h2>
<div class="container">
    <!-- 입력 -->
    <textarea id="input" placeholder="여기에 Markdown 내용을 입력하세요..."></textarea>

    <!-- 결과 -->
    <textarea id="output" readonly></textarea>
</div>

<div id="copyAlert">✔️ 복사 완료</div>

<script>
const input = document.getElementById('input');
const output = document.getElementById('output');
const copyAlert = document.getElementById('copyAlert');

// Markdown 변환 함수
function cleanMarkdown(text) {
    const lines = text.split(/\r?\n/);
    const result = [];

    for (let line of lines) {
        const trimmed = line.trim();

        // 테이블 감지
        const isTableLine = /^\s*\|.*\|\s*$/.test(trimmed);

        // '---' 단독 줄 제거 (테이블 제외)
        if (!isTableLine && /^-{3,}\s*$/.test(trimmed)) continue;

        // Markdown 링크 제거 ([텍스트](링크) → 텍스트)
        let cleanedLine = line.replace(/\(\[.*?\]\)/g, '');

        result.push(cleanedLine);
    }

    return result.join("\n");
}

// 클립보드 복사 함수
function copyToClipboard(text) {
    navigator.clipboard.writeText(text).then(() => {
        copyAlert.style.display = 'block';
        clearTimeout(copyAlert._timeout);
        copyAlert._timeout = setTimeout(() => {
            copyAlert.style.display = 'none';
        }, 1500);
    }).catch(err => {
        console.error('복사 실패:', err);
    });
}

// 실시간 변환 + 자동 복사
input.addEventListener('input', () => {
    const cleaned = cleanMarkdown(input.value);
    output.value = cleaned;
    if (cleaned.trim() !== "") {
        copyToClipboard(cleaned);
    }
});

// 초기 표시 및 복사
const initial = cleanMarkdown(input.value);
output.value = initial;
copyToClipboard(initial);
</script>

</body>
</html>
